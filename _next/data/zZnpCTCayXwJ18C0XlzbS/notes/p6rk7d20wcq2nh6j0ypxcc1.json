{"pageProps":{"note":{"id":"p6rk7d20wcq2nh6j0ypxcc1","title":"Map Reduce","desc":"","updated":1716742651449,"created":1716296936722,"custom":{},"fname":"engineering.infrastructure.map-reduce","type":"note","vault":{"fsPath":"vault"},"contentHash":"ad65a0fba02ebba7f9a8412e394a1fb0","links":[{"type":"wiki","from":{"fname":"engineering.infrastructure.map-reduce","id":"p6rk7d20wcq2nh6j0ypxcc1","vaultName":"vault"},"value":"engineering.infrastructure.mit6824","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":39,"offset":39},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"engineering.infrastructure.mit6824"}}],"anchors":{"blog-post-notes":{"type":"header","text":"Blog post notes","value":"blog-post-notes","line":22,"column":0,"depth":2},"what-is-mapreduce":{"type":"header","text":"What is mapreduce?","value":"what-is-mapreduce","line":24,"column":0,"depth":3},"paradigm":{"type":"header","text":"Paradigm","value":"paradigm","line":29,"column":0,"depth":3},"implementation":{"type":"header","text":"Implementation","value":"implementation","line":93,"column":0,"depth":3}},"children":[],"parent":"7ctuylovxtre110gd543zht","data":{}},"body":"<h1 id=\"map-reduce\">Map Reduce<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#map-reduce\"></a></h1>\n<p><a href=\"/notes/naccvbzk14d5xi46rmz5or8\">MIT 6.824</a></p>\n<pre><code>Input1 -> Map -> a,1 b,1\nInput2 -> Map ->     b,1\nInput3 -> Map -> a,1     c,1\n                |   |   |\n                |   |   -> Reduce -> c,1\n                |   -----> Reduce -> b,2\n                ---------> Reduce -> a,2\n</code></pre>\n<p>Paper: <a href=\"https://pdos.csail.mit.edu/6.824/papers/mapreduce.pdf\">https://pdos.csail.mit.edu/6.824/papers/mapreduce.pdf</a></p>\n<h2 id=\"blog-post-notes\">Blog post notes<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#blog-post-notes\"></a></h2>\n<h3 id=\"what-is-mapreduce\">What is mapreduce?<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#what-is-mapreduce\"></a></h3>\n<ul>\n<li>A way to run large parallel jobs for processing large datasets easily.</li>\n<li>Paper by Jeffrey Dean and Sanjay Ghemawat</li>\n</ul>\n<h3 id=\"paradigm\">Paradigm<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#paradigm\"></a></h3>\n<ul>\n<li>User writes simple map and reduce functions.</li>\n<li>The MapReduce implementation takes input, calls map over the input to\ncreate intermediate output and then calls reduce over this intermediate\noutput to get the final form.</li>\n</ul>\n<p>Let's show the canonical word count example:</p>\n<p>map and reduce functions has the following signature</p>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> KeyValue <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    Key <span class=\"token builtin\">string</span>\n    Value <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">Map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">string</span> key<span class=\"token punctuation\">,</span> <span class=\"token builtin\">string</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>KeyValue <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">Reduce</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">string</span> key<span class=\"token punctuation\">,</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> values<span class=\"token punctuation\">)</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>As we can see from the signatures:</p>\n<ul>\n<li>Map takes a key and a value as input, and then creates a list of key, value pairs from this input</li>\n<li>Reduce then takes all the values for each intermediate key, and uses these values to generate the final result for the key</li>\n</ul>\n<p>For word count, let's set some background</p>\n<p>TODO: BACKGROUND HERE</p>\n<ul>\n<li>files with lots of words.</li>\n<li>want to count the frequency of each word across the dataset</li>\n</ul>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">Map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">string</span> key<span class=\"token punctuation\">,</span> <span class=\"token builtin\">string</span> contents<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>KeyValue <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// function to detect word separators.</span>\n\tff <span class=\"token operator\">:=</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span>r <span class=\"token builtin\">rune</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">bool</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token operator\">!</span>unicode<span class=\"token punctuation\">.</span><span class=\"token function\">IsLetter</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n\n\t<span class=\"token comment\">// split contents into an array of words.</span>\n\twords <span class=\"token operator\">:=</span> strings<span class=\"token punctuation\">.</span><span class=\"token function\">FieldsFunc</span><span class=\"token punctuation\">(</span>contents<span class=\"token punctuation\">,</span> ff<span class=\"token punctuation\">)</span>\n\n\tkva <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>KeyValue<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">for</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> w <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> words <span class=\"token punctuation\">{</span>\n\t\tkv <span class=\"token operator\">:=</span> mr<span class=\"token punctuation\">.</span>KeyValue<span class=\"token punctuation\">{</span>w<span class=\"token punctuation\">,</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">}</span>\n\t\tkva <span class=\"token operator\">=</span> <span class=\"token function\">append</span><span class=\"token punctuation\">(</span>kva<span class=\"token punctuation\">,</span> kv<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span> kva\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>TODO: Explain what map does here</p>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">Reduce</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">string</span> key<span class=\"token punctuation\">,</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> values<span class=\"token punctuation\">)</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> strconv<span class=\"token punctuation\">.</span><span class=\"token function\">Itoa</span><span class=\"token punctuation\">(</span><span class=\"token function\">len</span><span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>TODO: Explain what reduce does here</p>\n<h3 id=\"implementation\">Implementation<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#implementation\"></a></h3>\n<p>TODO</p>","noteIndex":{"id":"root","title":"Notes","desc":"","updated":1676546314176,"created":1595961348801,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"a63bc749050c89d4e92bc7f1ce268820","links":[{"type":"wiki","from":{"fname":"root","id":"root","vaultName":"vault"},"value":"history.laphams_quarterly.democracy.campaign_finance","position":{"start":{"line":13,"column":3,"offset":455},"end":{"line":13,"column":59,"offset":511},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"history.laphams_quarterly.democracy.campaign_finance"}},{"type":"wiki","from":{"fname":"root","id":"root","vaultName":"vault"},"value":"engineering.being_a_mentor","position":{"start":{"line":14,"column":3,"offset":514},"end":{"line":14,"column":33,"offset":544},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"engineering.being_a_mentor"}},{"type":"wiki","from":{"fname":"root","id":"root","vaultName":"vault"},"value":"history.china.dynasties","position":{"start":{"line":15,"column":3,"offset":547},"end":{"line":15,"column":30,"offset":574},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"history.china.dynasties"}},{"type":"wiki","from":{"fname":"root","id":"root","vaultName":"vault"},"value":"history.india.indira_gandhi","position":{"start":{"line":16,"column":3,"offset":577},"end":{"line":16,"column":34,"offset":608},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"history.india.indira_gandhi"}},{"type":"wiki","from":{"fname":"root","id":"root","vaultName":"vault"},"value":"books","alias":"here","position":{"start":{"line":18,"column":35,"offset":644},"end":{"line":18,"column":49,"offset":658},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"books"}},{"type":"wiki","from":{"fname":"root","id":"root","vaultName":"vault"},"value":"engineering.dendron","alias":"Dendron","position":{"start":{"line":20,"column":21,"offset":681},"end":{"line":20,"column":52,"offset":712},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"engineering.dendron"}}],"anchors":{},"children":["05zaQJMyCo5kYcUdfqHbU","3dca4f75-0a84-4596-8fd3-38f0adbef2b9","2fr0tv2ahut83b6g2w81mz0","596IGh04441uyLbbpkFT1","3j8u7RlelDYoffRQgMIYg","vwq8iGNrINwTnn2qz9cR1","J6qb2iUM2ZMqAYgQQELzQ","tbk0j8n293h69lwldtfsg3u","fSkjQcqYZTGdomGRSlszf","T4ea2dCnXXW7SbPu0BnwF","sfaxl8m0scx0iylroh2nt27","G9wFXoaipKfEf6FlKdHH0","qvk3fygz1m6ws2fji5retj1","8zcz6vwjqab27tqeygao1p7","7nAQ226q3pwfVvQ9KSV80","XLgWwAI1l8XFqJ55YDMXU","Y48aQXzL3qv0LWZAG5Kbz","njqts253mv1fp9o0jkcw1fe","ceddHaDRTozEjfGqQbeNi","9bn8iwfv72uv75ionw8ftql","qjsa2cqk7wwmsxkd63tqmzo","i137wds83cgyiqkpuorvrgh","nbajhp0d12thgwdtlxlo4s5","j9m60mwn8tah0puxr287hbz","awb5kxy7q19yk7564umdlz1","sxs92ymdmvudd9w9abdf2xm","maqyjfimzm1xlreqrnp0ubv","occnxujjcmph9kqq4dtx79g","0r968pvsf565fs54ac85ug0","0iug0cqfida2w3bw9r2y39x","71jowrrvmteaz6vmk3ljq0z","4rahpe1jwc8wf301wril41i","ooi7xp8hw96cr9v8eeg0qxn","100p65il8y0afy0ut38euym","ue8gju4jz5sa6s57r0qbkeq","4uelk0suzbfnl472i8zxi5p","56i0l7vo9k1enmfm627d4q1","52ertzgdog1o9jfdtga8vvt","0lisa2vcu9jh435u9gks8p5"],"parent":null,"data":{},"body":"\nHi! I'm Param! This is a place for my personal notes.\n\nMy website is https://param.codes, and I write more readable\nstuff on my substack: https://newsletter.param.codes.\n\nI've found that taking notes helps me remember things, and it's nice\nto look back on information that you processed years ago. I jot down random things, there's no real structure, but some of these\nnotes could eventually become blog posts.\n\nSome notes you might find interesting:\n\n- [[history.laphams_quarterly.democracy.campaign_finance]]\n- [[engineering.being_a_mentor]]\n- [[history.china.dynasties]]\n- [[history.india.indira_gandhi]]\n\nI also keep notes on books I read [[here|books]].\n\nThis is built using [[Dendron|engineering.dendron]] and hosted using\n[GitHub Pages](https://github.com/paramsingh/notes).\n\nGet in touch via [Twitter](https://twitter.com/iliekcomputers) or email me at `me [at] param [dot] codes`!\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"previewV2Enabled":false,"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"dendronVersion":"0.89.0","vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"enableEditorDecorations":true,"enableHandlebarTemplates":true,"enableFullHierarchyNoteTitle":false,"enableSmartRefs":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"/param/notes","description":"param's notes"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","enableMermaid":true,"siteUrl":"https://notes.param.codes/","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}